# Aè‚¡å¼ºåŒ–å­¦ä¹ é‡åŒ–äº¤æ˜“ç³»ç»Ÿ

åŸºäºCVaR-PPOçš„Aè‚¡é‡åŒ–äº¤æ˜“æ™ºèƒ½ä½“ï¼Œä¸“æ³¨äºä½æ³¢åŠ¨ã€é«˜å¤æ™®æ¯”ç‡çš„ç¨³å¥æ”¶ç›Šç­–ç•¥ã€‚

## æ ¸å¿ƒç‰¹æ€§

### ğŸ¯ æŠ•èµ„ç›®æ ‡
- **å¹´åŒ–æ”¶ç›Šç‡**: â‰¥ 5%
- **æœ€å¤§å›æ’¤**: â‰¤ 10%  
- **å¹´åŒ–æ³¢åŠ¨ç‡**: 10-12%
- **å¤æ™®æ¯”ç‡**: > 0.5
- **å¿ƒç†èˆ’é€‚åº¦**: é«˜åº¦ä¼˜åŒ–

### ğŸ§  AIé©±åŠ¨
- **CVaR-PPOç®—æ³•**: æ¡ä»¶é£é™©ä»·å€¼çº¦æŸçš„ç­–ç•¥æ¢¯åº¦
- **å®‰å…¨ä¿æŠ¤å±‚**: Shielded-RLå®æ—¶é£é™©æ§åˆ¶
- **å› å­é©±åŠ¨**: å¤šç»´åº¦Alphaå› å­ + é£é™©å› å­

### ğŸ›¡ï¸ é£é™©ç®¡ç†
- **ç›®æ ‡æ³¢åŠ¨ç‡æ§åˆ¶**: åŠ¨æ€æ æ†è°ƒæ•´
- **é£é™©å¹³ä»·ä¼˜åŒ–**: å¤šç§æƒé‡åˆ†é…ç­–ç•¥
- **åŠ¨æ€æ­¢æŸ**: ç§»åŠ¨æ­¢æŸ + æœ€å¤§å›æ’¤ä¿æŠ¤
- **å®æ—¶ç›‘æ§**: VaR/CVaR/å›æ’¤å…¨æ–¹ä½ç›‘æ§

## ç³»ç»Ÿæ¶æ„

```
finance/
â”œâ”€â”€ data/              # æ•°æ®ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ data_manager.py
â”‚   â””â”€â”€ qlib_provider.py
â”œâ”€â”€ factors/           # å› å­å·¥ç¨‹æ¨¡å—
â”‚   â”œâ”€â”€ factor_engine.py
â”‚   â”œâ”€â”€ alpha_factors.py
â”‚   â””â”€â”€ risk_factors.py
â”œâ”€â”€ rl_agent/          # å¼ºåŒ–å­¦ä¹ æ¨¡å—
â”‚   â”œâ”€â”€ trading_environment.py
â”‚   â”œâ”€â”€ cvar_ppo_agent.py
â”‚   â””â”€â”€ safety_shield.py
â”œâ”€â”€ risk_control/      # é£é™©æ§åˆ¶æ¨¡å—
â”‚   â”œâ”€â”€ risk_controller.py
â”‚   â”œâ”€â”€ target_volatility.py
â”‚   â”œâ”€â”€ risk_parity.py
â”‚   â””â”€â”€ stop_loss.py
â”œâ”€â”€ backtest/          # å›æµ‹è¯„ä¼°æ¨¡å—
â”‚   â”œâ”€â”€ backtest_engine.py
â”‚   â”œâ”€â”€ performance_analyzer.py
â”‚   â””â”€â”€ comfort_metrics.py
â”œâ”€â”€ config/            # é…ç½®ç®¡ç†æ¨¡å—
â”œâ”€â”€ utils/             # å·¥å…·æ¨¡å—
â”œâ”€â”€ examples/          # ç¤ºä¾‹ä»£ç 
â””â”€â”€ main.py           # ä¸»ç¨‹åº
```

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# åˆå§‹åŒ–qlibæ•°æ®
# æŒ‰ç…§qlibå®˜æ–¹æ–‡æ¡£é…ç½®ä¸­å›½Aè‚¡æ•°æ®
```

### 2. è¿è¡Œæ¼”ç¤º

```bash
# å¿«é€Ÿæ¼”ç¤º
python examples/quick_start.py

# æŸ¥çœ‹ç³»ç»ŸåŠŸèƒ½
python main.py --help
```

### 3. å®Œæ•´æµç¨‹

```bash
# è®­ç»ƒæ™ºèƒ½ä½“
python main.py --mode train

# è¿è¡Œå›æµ‹
python main.py --mode backtest --model ./models/best_agent.pth

# å®Œæ•´æµç¨‹ï¼ˆè®­ç»ƒ+å›æµ‹ï¼‰
python main.py --mode full
```

## é…ç½®è¯´æ˜

### é»˜è®¤é…ç½®

ç³»ç»Ÿæä¾›å®Œæ•´çš„é»˜è®¤é…ç½®ï¼Œè¦†ç›–æ‰€æœ‰æ¨¡å—å‚æ•°ï¼š

```python
from config import ConfigManager

config = ConfigManager()
config.print_config_summary()
```

### è‡ªå®šä¹‰é…ç½®

åˆ›å»ºYAMLæˆ–JSONé…ç½®æ–‡ä»¶ï¼š

```yaml
# config.yaml
data:
  start_date: '2020-01-01'
  end_date: '2023-12-31'
  universe: 'csi300'

agent:
  learning_rate: 3e-4
  cvar_threshold: -0.02

risk_control:
  target_volatility: 0.12
  max_leverage: 1.2
```

ä½¿ç”¨è‡ªå®šä¹‰é…ç½®ï¼š
```bash
python main.py --config config.yaml --mode full
```

## æ ¸å¿ƒæ¨¡å—è¯¦è§£

### 1. æ•°æ®ç®¡ç† (data/)
- åŸºäºqlibçš„ç»Ÿä¸€æ•°æ®æ¥å£
- æ”¯æŒå¤šç§æ•°æ®æºï¼ˆYahoo Finance, æœ¬åœ°æ•°æ®ç­‰ï¼‰
- è‡ªåŠ¨æ•°æ®æ¸…æ´—å’Œé¢„å¤„ç†

### 2. å› å­å·¥ç¨‹ (factors/)
- **Alphaå› å­**: åŠ¨é‡ã€åè½¬ã€æŠ€æœ¯æŒ‡æ ‡ç­‰
- **é£é™©å› å­**: æ³¢åŠ¨ç‡ã€è´å¡”ã€VaRç­‰  
- **ä½æ³¢åŠ¨ç­›é€‰**: è‡ªåŠ¨ç­›é€‰ä½æ³¢åŠ¨è‚¡ç¥¨æ± 

### 3. å¼ºåŒ–å­¦ä¹  (rl_agent/)
- **CVaR-PPO**: é›†æˆæ¡ä»¶é£é™©ä»·å€¼çº¦æŸ
- **äº¤æ˜“ç¯å¢ƒ**: è€ƒè™‘äº¤æ˜“æˆæœ¬ã€æ»‘ç‚¹çš„çœŸå®ç¯å¢ƒ
- **å®‰å…¨ä¿æŠ¤**: å¤šå±‚æ¬¡é£é™©çº¦æŸå’ŒåŠ¨ä½œä¿®æ­£

### 4. é£é™©æ§åˆ¶ (risk_control/)
- **ç›®æ ‡æ³¢åŠ¨ç‡**: åŠ¨æ€è°ƒæ•´ç»„åˆæ æ†
- **é£é™©å¹³ä»·**: å¤šç§æƒé‡ä¼˜åŒ–ç­–ç•¥
- **åŠ¨æ€æ­¢æŸ**: æ™ºèƒ½æ­¢æŸå’Œå†å¹³è¡¡

### 5. å›æµ‹è¯„ä¼° (backtest/)
- **ç»©æ•ˆåˆ†æ**: å…¨é¢çš„é£é™©æ”¶ç›ŠæŒ‡æ ‡
- **å¿ƒç†èˆ’é€‚åº¦**: é‡åŒ–æŠ•èµ„å¿ƒç†æ„Ÿå—
- **å¯¹æ¯”åˆ†æ**: ä¸åŸºå‡†çš„è¯¦ç»†å¯¹æ¯”

## å¿ƒç†èˆ’é€‚åº¦æŒ‡æ ‡

ç³»ç»Ÿä¸“é—¨è®¾è®¡äº†å¿ƒç†èˆ’é€‚åº¦è¯„ä¼°ä½“ç³»ï¼š

- **æœˆåº¦æœ€å¤§å›æ’¤** < 5%
- **è¿ç»­äºæŸå¤©æ•°** < 5å¤©
- **ä¸‹è·Œæ—¥å æ¯”** < 40%
- **95% VaR** < 1%
- **ç»¼åˆèˆ’é€‚åº¦å¾—åˆ†** 0-100åˆ†

## æ€§èƒ½é¢„æœŸ

æ ¹æ®æ¶æ„è®¾è®¡ï¼Œç³»ç»Ÿé¢„æœŸå®ç°ï¼š

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | å¤‡æ³¨ |
|------|--------|------|
| å¹´åŒ–æ”¶ç›Šç‡ | 6-9% | åŸºäºå†å²å›æµ‹ |
| æœ€å¤§å›æ’¤ | â‰¤10% | å¤šå±‚é£é™©æ§åˆ¶ |
| å¹´åŒ–æ³¢åŠ¨ç‡ | â‰ˆ11% | ç›®æ ‡æ³¢åŠ¨ç‡ç®¡ç† |
| å¤æ™®æ¯”ç‡ | 0.6-0.8 | é£é™©è°ƒæ•´åæ”¶ç›Š |
| æœˆåº¦æœ€å¤§å›æ’¤ | <5% | å¿ƒç†èˆ’é€‚åº¦ä¿éšœ |

## æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°å› å­

```python
# factors/alpha_factors.py
def calculate_my_factor(self, price_data, volume_data):
    # å®ç°æ‚¨çš„å› å­é€»è¾‘
    return factor_values
```

### è‡ªå®šä¹‰é£é™©æ§åˆ¶

```python
# risk_control/custom_control.py
class CustomRiskControl:
    def __init__(self, config):
        pass
    
    def process_weights(self, weights):
        # å®ç°è‡ªå®šä¹‰é£é™©æ§åˆ¶é€»è¾‘
        return adjusted_weights
```

### é›†æˆæ–°æ•°æ®æº

```python
# data/custom_provider.py
class CustomDataProvider:
    def get_data(self, symbols, start_date, end_date):
        # å®ç°æ•°æ®è·å–é€»è¾‘
        return data
```

## æ³¨æ„äº‹é¡¹

1. **æ•°æ®è´¨é‡**: ç¡®ä¿qlibæ•°æ®æºé…ç½®æ­£ç¡®
2. **è®¡ç®—èµ„æº**: è®­ç»ƒéœ€è¦ä¸€å®šçš„è®¡ç®—èµ„æºï¼Œå»ºè®®ä½¿ç”¨GPU
3. **é£é™©æç¤º**: æœ¬ç³»ç»Ÿä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œå®ç›˜äº¤æ˜“éœ€è°¨æ…
4. **å›æµ‹vså®ç›˜**: å›æµ‹ç»“æœä¸ä»£è¡¨å®ç›˜è¡¨ç°ï¼Œå­˜åœ¨è¿‡æ‹Ÿåˆé£é™©

## æŠ€æœ¯ç‰¹ç‚¹

- **æ¨¡å—åŒ–è®¾è®¡**: å„æ¨¡å—ç‹¬ç«‹ï¼Œæ˜“äºæ‰©å±•å’Œç»´æŠ¤
- **é…ç½®é©±åŠ¨**: ä¸°å¯Œçš„é…ç½®é€‰é¡¹ï¼Œæ”¯æŒå¤šç§è¿è¡Œæ¨¡å¼  
- **å¼‚å¸¸å®‰å…¨**: å»é™¤try-exceptï¼Œç›´æ¥æš´éœ²å¼‚å¸¸ä¾¿äºè°ƒè¯•
- **ä»£ç çº¦æŸ**: å•æ–‡ä»¶â‰¤500è¡Œï¼Œä¿æŒä»£ç æ¸…æ™°
- **ä¸­æ–‡ä¼˜åŒ–**: å…¨é¢æ”¯æŒä¸­æ–‡æ•°æ®å’Œè¾“å‡º

## è®¸å¯è¯

MIT License

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

---

**å…è´£å£°æ˜**: æœ¬é¡¹ç›®ä»…ä¾›å­¦æœ¯ç ”ç©¶å’Œå­¦ä¹ ä½¿ç”¨ï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®ã€‚ä½¿ç”¨è€…éœ€è‡ªè¡Œæ‰¿æ‹…æŠ•èµ„é£é™©ã€‚